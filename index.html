<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jalaram Academy v251</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <style>
        :root { --primary: #4f46e5; --bg: #f8fafc; --text: #0f172a; --chat-me: #4f46e5; --chat-them: #e2e8f0; }
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Plus Jakarta Sans',sans-serif; -webkit-tap-highlight-color:transparent; }
        body { background:var(--bg); color:var(--text); height:100vh; display:flex; flex-direction:column; overflow:hidden; }

        /* AUTH */
        #auth-layer { position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:5000; display:flex; flex-direction:column; align-items:center; justify-content:center; }
        .auth-card { width:320px; text-align:center; }

        /* APP HEADER (EMOTIONAL) */
        .emo-header { background:linear-gradient(135deg, #4f46e5, #818cf8); padding:20px; color:white; border-radius:0 0 25px 25px; box-shadow:0 4px 20px rgba(79, 70, 229, 0.2); flex-shrink:0; }
        .mood-row { display:flex; gap:10px; margin-top:15px; overflow-x:auto; }
        .mood-chip { background:rgba(255,255,255,0.2); padding:6px 12px; border-radius:20px; font-size:12px; border:1px solid rgba(255,255,255,0.1); cursor:pointer; white-space:nowrap; }

        /* LAYOUT */
        .app-shell { display:flex; flex:1; overflow:hidden; }
        .main-content { flex:1; overflow-y:auto; padding:20px; padding-bottom:100px; }

        /* UI ELEMENTS */
        .u-card { background:white; padding:15px; border-radius:16px; box-shadow:0 4px 10px rgba(0,0,0,0.03); margin-bottom:15px; border:1px solid #e2e8f0; }
        .row { display:flex; justify-content:space-between; align-items:center; }
        .btn { padding:12px; border:none; border-radius:10px; font-weight:700; cursor:pointer; width:100%; font-size:13px; margin-bottom:10px; }
        .btn-sm { width:auto; padding:6px 12px; margin:0; }
        .btn-main { background:var(--primary); color:white; }
        .btn-sec { background:#f1f5f9; color:#475569; border:1px solid #cbd5e1; }
        input, select { width:100%; padding:12px; border:2px solid #e2e8f0; border-radius:10px; margin-bottom:10px; outline:none; background:white; }

        /* LEADERBOARD */
        .podium { display:flex; align-items:flex-end; justify-content:center; gap:10px; margin-bottom:20px; height:130px; }
        .pod-bar { width:60px; border-radius:10px 10px 0 0; display:flex; flex-direction:column; align-items:center; justify-content:flex-end; padding-bottom:5px; color:white; font-weight:bold; position:relative; }
        .rank-1 { height:100%; background:#f59e0b; } .rank-2 { height:80%; background:#94a3b8; } .rank-3 { height:60%; background:#b45309; }
        .crown { position:absolute; top:-25px; font-size:20px; }

        /* CHAT */
        .chat-item { display:flex; gap:10px; padding:15px; border-bottom:1px solid #f1f5f9; align-items:center; cursor:pointer; }
        .chat-win { position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:2000; display:none; flex-direction:column; }
        .chat-body { flex:1; background:#f8fafc; padding:15px; overflow-y:auto; }
        .msg { max-width:70%; padding:8px 12px; border-radius:15px; font-size:13px; margin-bottom:5px; clear:both; }
        .msg-me { float:right; background:var(--chat-me); color:white; }
        .msg-them { float:left; background:var(--chat-them); }

        /* MODALS */
        .modal-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:9000; display:none; justify-content:center; align-items:center; }
        .modal-box { background:white; width:90%; max-width:350px; padding:20px; border-radius:16px; max-height:80vh; overflow-y:auto; }
        
        /* NAV */
        .bot-nav { position:fixed; bottom:0; width:100%; background:white; display:flex; justify-content:space-around; padding:10px; border-top:1px solid #eee; z-index:1000; }
        .nav-item { text-align:center; font-size:10px; color:#94a3b8; font-weight:bold; }
        .nav-item.active { color:var(--primary); }
        .nav-item i { font-size:24px; display:block; }

        /* UTILS */
        .teacher-only, .admin-only { display:none; }
        .sim-banner { background:#f97316; color:white; text-align:center; padding:8px; font-weight:bold; font-size:11px; cursor:pointer; display:none; }
    </style>
</head>
<body>

    <div id="auth-layer">
        <div class="auth-card">
            <div style="font-size:60px; margin-bottom:10px;">üéì</div>
            <h2 style="color:var(--primary); margin-bottom:20px;">Jalaram Academy</h2>
            <select id="l-role"><option>Admin</option><option>Teacher</option><option>Student</option></select>
            <input id="l-id" placeholder="ID (e.g. ADM-001)">
            <input type="password" id="l-pass" placeholder="PIN (1234)">
            <button class="btn btn-main" onclick="handleLogin()">Login</button>
            <div style="margin-top:15px; padding-top:15px; border-top:1px solid #eee;">
                <button class="btn btn-sec" onclick="showModal('reg-modal')">New Student? Register</button>
                <button class="btn btn-sec" onclick="showModal('public-modal')">View Courses</button>
            </div>
        </div>
    </div>

    <div id="app-layer" style="display:none; height:100%; flex-direction:column;">
        
        <div class="emo-header">
            <div class="row">
                <div style="font-weight:800; font-size:18px;">Jalaram Academy</div>
                <div id="u-chip" style="font-size:11px; background:rgba(255,255,255,0.2); padding:4px 10px; border-radius:15px;">User</div>
            </div>
            <div class="emo-greet" id="greet-text">Good Morning!</div>
            <div style="opacity:0.9; font-size:13px;">Ready to conquer the day?</div>
            <div class="mood-row" id="mood-bar">
                <div class="mood-chip">üòÑ Happy</div><div class="mood-chip">üß† Focused</div><div class="mood-chip">üò¥ Tired</div>
            </div>
        </div>

        <div class="sim-banner" id="sim-bar" onclick="location.reload()">‚ö†Ô∏è SIMULATING - TAP TO EXIT</div>

        <main class="main-content">
            
            <div id="pane-home" class="pane">
                <div class="u-card">
                    <h3>üèÜ Class 10 Leaderboard</h3>
                    <div class="podium">
                        <div class="pod-bar rank-2"><div class="crown">ü•à</div><small>Rohan</small>92%</div>
                        <div class="pod-bar rank-1"><div class="crown">üëë</div><small>Anjali</small>98%</div>
                        <div class="pod-bar rank-3"><div class="crown">ü•â</div><small>Dev</small>89%</div>
                    </div>
                    <div id="lb-list"></div>
                </div>
            </div>

            <div id="pane-batches" class="pane" style="display:none;">
                <div class="row"><h3>Batches</h3><button class="btn btn-sec btn-sm admin-only" onclick="addBatch()">+ Batch</button></div>
                <div id="batch-list"></div>
                
                <div id="batch-detail" style="display:none; margin-top:20px; border-top:2px solid #eee; padding-top:20px;">
                    <div class="row"><b id="bd-title">Batch</b><button class="btn btn-sec btn-sm" onclick="document.getElementById('batch-detail').style.display='none'">Close</button></div>
                    
                    <div class="teacher-only" style="background:#f0f9ff; padding:10px; border-radius:10px; margin:10px 0; border:1px solid #bfdbfe;">
                        <b style="color:var(--primary);">‚ö° Quantum Generator</b>
                        <input id="q-topic" placeholder="Topic" style="margin:5px 0;">
                        <div class="row"><select id="q-buf" style="margin:0; width:48%;"><option>No Buffer</option><option>10m Buffer</option></select><button class="btn btn-main btn-sm" style="width:48%;" onclick="alert('Quantum Sent!')">Notify</button></div>
                    </div>

                    <div class="row" style="margin-top:10px;">
                        <b>Students</b>
                        <div class="teacher-only"><button class="btn btn-sec btn-sm" onclick="renderStudents('att')">Att.</button> <button class="btn btn-sec btn-sm" onclick="renderStudents('marks')">Marks</button></div>
                    </div>
                    <div id="bd-list"></div>
                </div>
            </div>

            <div id="pane-chat" class="pane" style="display:none;">
                <div class="u-card"><h3>Messages</h3><div id="chat-list"></div></div>
            </div>

            <div id="pane-store" class="pane" style="display:none;">
                <div class="u-card">
                    <div class="row"><h3>Store</h3><button class="btn btn-sec btn-sm admin-only" onclick="addMaterial()">+ Add</button></div>
                    <h4>Free Demos</h4><div id="demo-list"></div>
                    <h4 style="margin-top:15px;">Premium</h4><div id="store-list"></div>
                </div>
            </div>

            <div id="pane-admin" class="pane" style="display:none;">
                <div class="u-card">
                    <div class="row"><h3>Database</h3><button class="btn btn-sec btn-sm" onclick="alert('Add Logic')">+ User</button></div>
                    <input placeholder="Search..." onkeyup="renderAdmin(this.value)">
                    <div id="admin-list"></div>
                </div>
            </div>

            <div id="pane-profile" class="pane" style="display:none;">
                <div class="u-card">
                    <h4>Profile</h4>
                    <label style="font-size:11px; font-weight:bold;">USER ID</label><input id="prof-id" readonly style="background:#eee;">
                    <label style="font-size:11px; font-weight:bold;">NAME</label><input id="prof-name">
                    <button class="btn btn-main" onclick="alert('Saved')">Update</button>
                </div>
            </div>

        </main>
        <div class="bot-nav" id="bot-nav"></div>
    </div>

    <div id="reg-modal" class="modal-overlay" onclick="hideModals()">
        <div class="modal-box" onclick="event.stopPropagation()">
            <h3>Register</h3>
            <input id="r-name" placeholder="Name">
            <select id="r-role"><option>Student</option><option>Teacher</option></select>
            <input id="r-pass" placeholder="Create PIN">
            <button class="btn btn-main" onclick="handleReg()">Register</button>
            <button class="btn btn-sec" onclick="hideModals()">Close</button>
        </div>
    </div>

    <div id="public-modal" class="modal-overlay" onclick="hideModals()">
        <div class="modal-box" onclick="event.stopPropagation()">
            <h3>Available Courses</h3>
            <div style="padding:10px; border-bottom:1px solid #eee; cursor:pointer;" onclick="aiDesc('Maths')"><b>Maths</b><br><small>Click for AI Info</small></div>
            <div style="padding:10px; border-bottom:1px solid #eee; cursor:pointer;" onclick="aiDesc('Science')"><b>Science</b><br><small>Click for AI Info</small></div>
            <div id="ai-out" style="margin-top:10px; padding:10px; background:#f8fafc; font-size:13px;"></div>
            <button class="btn btn-sec" style="margin-top:10px;" onclick="hideModals()">Close</button>
        </div>
    </div>

    <div id="chat-window" class="chat-win">
        <div class="row" style="padding:15px; border-bottom:1px solid #eee;"><i class="material-icons" onclick="document.getElementById('chat-window').style.display='none'">arrow_back</i><b id="cw-title">Chat</b><div></div></div>
        <div class="chat-body" id="cw-body"></div>
        <div style="padding:10px; border-top:1px solid #eee; display:flex; gap:10px;"><input placeholder="Type..." style="margin:0;"><button class="btn btn-main" style="width:auto;">Send</button></div>
    </div>

    <div id="inspect-modal" class="modal-overlay" onclick="hideModals()">
        <div class="modal-box" onclick="event.stopPropagation()">
            <h3 id="ins-name">User</h3><p id="ins-id">ID</p>
            <button class="btn btn-main" style="background:#f97316;" onclick="simUser()">üëÅÔ∏è Simulate View</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        let users = [
            {n:'Admin', m:'ADM-001', p:'1234', role:'Admin'},
            {n:'Amit Sir', m:'TCH-001', p:'1234', role:'Teacher'},
            {n:'Rohan', m:'STU-001', p:'1234', role:'Student', batch:'Class 10 A', marks:95},
            {n:'Anjali', m:'STU-002', p:'1234', role:'Student', batch:'Class 10 A', marks:98}
        ];
        let batches = ['Class 10 A', 'Class 12'];
        let store = [{t:'Algebra Intro', type:'Demo'}, {t:'Physics PDF', type:'Premium'}];
        let currentUser = null;

        // --- AUTH ---
        function showModal(id) { document.getElementById(id).style.display='flex'; }
        function hideModals() { document.querySelectorAll('.modal-overlay').forEach(e=>e.style.display='none'); }
        
        function handleLogin() {
            let id = document.getElementById('l-id').value;
            let u = users.find(x => x.m === id);
            if(u) { currentUser = u; startApp(); } else { alert("Try ADM-001 / 1234"); }
        }

        function handleReg() {
            let n=document.getElementById('r-name').value, r=document.getElementById('r-role').value;
            let id = (r==='Student'?'STU':'TCH') + '-' + Math.floor(Math.random()*1000);
            users.push({n:n, m:id, p:'1234', role:r, batch:'Class 10 A', marks:0});
            alert("ID: "+id); hideModals();
        }

        // --- APP LOGIC ---
        function startApp() {
            document.getElementById('auth-layer').style.display='none';
            document.getElementById('app-layer').style.display='flex';
            document.getElementById('u-chip').innerText = currentUser.n;
            
            // Greeting
            let h = new Date().getHours();
            document.getElementById('greet-text').innerText = `${h<12?'Good Morning':'Good Evening'}, ${currentUser.n}`;
            document.getElementById('mood-bar').style.display = currentUser.role==='Student'?'flex':'none';

            // Visibility
            document.querySelectorAll('.admin-only').forEach(e=>e.style.display=currentUser.role==='Admin'?'block':'none');
            document.querySelectorAll('.teacher-only').forEach(e=>e.style.display=(currentUser.role==='Teacher'||currentUser.role==='Admin')?'block':'none');

            // Build Nav
            let items = [];
            if(currentUser.role==='Admin') items = ['Admin', 'Batches', 'Store', 'Profile'];
            else if(currentUser.role==='Teacher') items = ['Batches', 'Chat', 'Profile'];
            else items = ['Home', 'Chat', 'Store', 'Profile'];

            let html = items.map(i => {
                let icon = {'Home':'home','Admin':'admin_panel_settings','Batches':'class','Store':'store','Chat':'chat','Profile':'person'}[i];
                return `<div class="nav-item" onclick="showPane('pane-${i.toLowerCase()}')"><i class="material-icons">${icon}</i>${i}</div>`;
            }).join('');
            document.getElementById('bot-nav').innerHTML = html;

            showPane('pane-'+items[0].toLowerCase());
        }

        function showPane(id) {
            document.querySelectorAll('.pane').forEach(e=>e.style.display='none');
            document.getElementById(id).style.display='block';
            
            if(id==='pane-home') renderLeaderboard();
            if(id==='pane-batches') renderBatches();
            if(id==='pane-chat') renderChat();
            if(id==='pane-store') renderStore();
            if(id==='pane-admin') renderAdmin('');
            if(id==='pane-profile') {
                document.getElementById('prof-name').value = currentUser.n;
                document.getElementById('prof-id').value = currentUser.m;
            }
        }

        // --- FEATURES ---
        function renderLeaderboard() {
            document.getElementById('lb-list').innerHTML = users.filter(u=>u.role==='Student').map((u,i)=>
                `<div class="lb-row"><div><b>${u.n}</b></div><span style="color:blue;">${u.marks}%</span></div>`
            ).join('');
        }

        function renderBatches() {
            document.getElementById('batch-list').innerHTML = batches.map(b => 
                `<div class="u-card" onclick="openBatch('${b}')" style="cursor:pointer;"><b>${b}</b></div>`
            ).join('');
        }
        function openBatch(b) {
            document.getElementById('batch-detail').style.display='block';
            document.getElementById('bd-title').innerText = b;
            renderStudents('view');
        }
        function renderStudents(mode) {
            let b = document.getElementById('bd-title').innerText;
            document.getElementById('bd-list').innerHTML = users.filter(u=>u.batch===b && u.role==='Student').map(u => {
                let act = mode==='att' ? `<button class="btn-sec btn-sm">P</button>` : (mode==='marks' ? `<input style="width:40px; margin:0;" placeholder="${u.marks}">` : `<small>${u.m}</small>`);
                return `<div class="row" style="padding:10px; border-bottom:1px solid #eee;"><b>${u.n}</b><div>${act}</div></div>`;
            }).join('');
        }
        function addBatch() { let b=prompt("Name:"); if(b) { batches.push(b); renderBatches(); } }

        function renderChat() {
            let list = currentUser.role==='Student' ? users.filter(u=>u.role==='Teacher') : users.filter(u=>u.role==='Student');
            document.getElementById('chat-list').innerHTML = list.map(u => 
                `<div class="chat-item" onclick="openChat('${u.n}')"><div class="chat-avatar" style="width:30px;height:30px;background:#ddd;border-radius:50%;"></div><b>${u.n}</b></div>`
            ).join('');
        }
        function openChat(n) {
            document.getElementById('chat-window').style.display='flex';
            document.getElementById('cw-title').innerText = n;
            document.getElementById('cw-body').innerHTML = `<div class="msg msg-them">Hello!</div><div class="msg msg-me">Hi there.</div>`;
        }

        function renderStore() {
            document.getElementById('demo-list').innerHTML = store.filter(x=>x.type==='Demo').map(i=>`<div class="store-item"><b>${i.t}</b></div>`).join('');
            document.getElementById('store-list').innerHTML = store.filter(x=>x.type!=='Demo').map(i=>`<div class="store-item"><b>${i.t}</b></div>`).join('');
        }
        function addMaterial() { store.push({t:'New File', type:'Premium'}); renderStore(); }

        function renderAdmin(q) {
            document.getElementById('admin-list').innerHTML = users.filter(u=>u.role!=='Admin' && u.n.toLowerCase().includes(q.toLowerCase())).map(u => 
                `<div class="row" style="padding:10px; border-bottom:1px solid #eee;" onclick="insp('${u.m}')"><b>${u.n}</b><span>${u.role}</span></div>`
            ).join('');
        }
        function insp(id) {
            let u = users.find(x=>x.m===id);
            document.getElementById('inspect-modal').style.display='flex';
            document.getElementById('ins-name').innerText = u.n;
            document.getElementById('ins-id').innerText = u.m;
            document.getElementById('inspect-modal').dataset.mid = id;
        }
        function simUser() {
            currentUser = users.find(x=>x.m===document.getElementById('inspect-modal').dataset.mid);
            hideModals();
            document.getElementById('sim-bar').style.display='block';
            startApp();
        }

        // --- PUBLIC AI ---
        function aiDesc(s) {
            document.getElementById('ai-out').innerText = "Generating AI Syllabus...";
            setTimeout(() => document.getElementById('ai-out').innerHTML = `<b>${s} Syllabus</b><br>AI Generated Content.<br>Topic 1: Intro...`, 1000);
        }
    </script>
</body>
</html>
